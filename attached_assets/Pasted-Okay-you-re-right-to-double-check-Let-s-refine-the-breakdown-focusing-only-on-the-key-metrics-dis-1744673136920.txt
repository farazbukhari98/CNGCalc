Okay, you're right to double-check. Let's refine the breakdown, focusing only on the key metrics displayed in the UI components and providing the specific information needed for the hover feature.

Component: FleetConfiguration.tsx (Summary Metrics)

Metric: Total Investment

Description: The total estimated capital required for the project over the analysis period. Includes vehicle costs and potentially the station cost upfront if "Turnkey" is selected.

Calculation:

Total Vehicle Investment = Sum over all years [ (Light Deployed * Light Cost) + (Medium Deployed * Medium Cost) + (Heavy Deployed * Heavy Cost) ] (Uses vehicleDistribution and vehicleParameters.xxxCost)

Station Cost = calculateStationCost(stationConfig, vehicleParameters) (See lib/calculator.ts)

Total Investment = Total Vehicle Investment + (stationConfig.turnkey ? Station Cost : 0)

Affecting Variables:

vehicleParameters (all Counts, all Costs)

stationConfig (stationType, businessType, turnkey)

deploymentStrategy / vehicleDistribution (Timing affects total vehicle cost calculation if not immediate)

timeHorizon (Affects total vehicles deployed in non-immediate strategies)

Metric: Payback Period

Description: The estimated time (in years and months) it takes for the cumulative savings generated by the project to equal the total initial investment. Note: Investment basis and savings calculation differ based on the Turnkey option.

Calculation: Time t where Cumulative Savings(t) >= Cumulative Investment(t). Calculated via loop and interpolation in calculateROI (lib/calculator.ts).

If Turnkey=Yes: Investment includes vehicles + station upfront. Savings are Gross (Fuel + Maintenance).

If Turnkey=No: Investment includes only vehicles upfront. Savings are Net (Gross Savings - Annual LDC Tariff).

Affecting Variables:

All vehicleParameters (Counts, Costs, MPG, Lifespan indirectly)

All stationConfig parameters (Type, LDC, Turnkey)

All fuelPrices (Gasoline, Diesel, CNG, Annual Increase)

timeHorizon

deploymentStrategy / vehicleDistribution

Metric: ROI (Return on Investment)

Description: The total net profit (or loss) over the selected Time Horizon, expressed as a percentage of the total investment. Note: Investment basis and savings calculation differ based on the Turnkey option.

Calculation: ROI = (Cumulative Savings at Horizon - Total Investment) / Total Investment * 100. (See calculateROI in lib/calculator.ts).

If Turnkey=Yes: Investment includes vehicles + station. Savings are Gross.

If Turnkey=No: Investment includes only vehicles. Savings are Net (Gross - Tariff).

Affecting Variables: (Same as Payback Period)

Metric: Annual Fuel Savings (Label might be simplified - represents Average Annual Net Savings)

Description: The average net savings generated per year over the entire time horizon. Includes fuel and maintenance savings, minus the LDC tariff if applicable.

Calculation: Average Annual Net Savings = Cumulative Savings at Horizon / Time Horizon. (Derived from results.cumulativeSavings in lib/calculator.ts).

Affecting Variables: (Same as Payback Period)

Metric: CO₂ Reduction (%)

Description: The estimated percentage reduction in CO₂ emissions over the time horizon compared to running the same fleet on conventional fuels.

Calculation: CO2 Reduction % = ((Total Baseline Emissions - Total CNG Emissions) / Total Baseline Emissions) * 100. Calculated year-by-year based on miles, MPG, emission factors ( g/mile ), and cumulative fleet size. (See calculateROI in lib/calculator.ts).

Affecting Variables:

vehicleParameters (all Counts, all MPG)

deploymentStrategy / vehicleDistribution

timeHorizon

Component: DeploymentTimeline.tsx (Per Year Block)

Metric: Investment (Year X)

Description: The capital investment made in this specific year. Primarily vehicle costs, but includes station cost in Year 1 if Turnkey=Yes.

Calculation:

Vehicle Investment (Year X) = (Light Deployed Year X * Light Cost) + (Medium Deployed Year X * Medium Cost) + (Heavy Deployed Year X * Heavy Cost)

Station Investment (Year 1 Only, if Turnkey=Yes) = calculateStationCost(...)

Total Investment (Year X) = Vehicle Investment (Year X) + (if Year=1 and Turnkey=Yes then Station Investment else 0)

Affecting Variables:

vehicleDistribution[Year X] (Light, Medium, Heavy counts for that year)

vehicleParameters (all Costs)

(For Year 1) stationConfig.turnkey, stationConfig.stationType, stationConfig.businessType, vehicleParameters (all counts for station sizing)

Metric: Savings (Year X)

Description: The net savings generated in this specific year by all vehicles operating in the fleet up to this year. Includes fuel and maintenance savings, less the LDC tariff if Turnkey=No.

Calculation: Yearly Savings (Year X) = (Fuel Savings + Maintenance Savings) for Cumulative Fleet(Year X) - (if Turnkey=No then Annual LDC Tariff else 0). (See calculateROI loop in lib/calculator.ts).

Affecting Variables: (Same as Payback Period - depends on cumulative fleet and all cost/price parameters up to that year).

Component: FinancialAnalysis.tsx

Metric: Payback Period

Description: Same as summary metric, often displayed more prominently. Time for cumulative savings to equal cumulative investment.

Calculation: Same as summary.

Affecting Variables: Same as summary.

Metric: Net Cash Flow ({timeHorizon}yr)

Description: The final net financial position (Total Cumulative Savings - Total Cumulative Investment) at the end of the selected time horizon.

Calculation: Net Cash Flow = results.cumulativeSavings[timeHorizon - 1] - results.cumulativeInvestment[timeHorizon - 1]

Affecting Variables: (Same as Payback Period)

Metric: {timeHorizon}-Year ROI

Description: Same as summary metric. Total net profit/loss as a percentage of total investment over the horizon.

Calculation: Same as summary.

Affecting Variables: (Same as Payback Period)

Metric: Annual Rate of Return

Description: The effective annualized rate of return over the project's time horizon, considering compounding.

Calculation: ARR = ( (Total Cumulative Savings / Total Investment) + 1 ) ^ (1 / Time Horizon) - 1 (Expressed as a percentage).

Affecting Variables: (Same as Payback Period)

Metric: LDC Investment Tariff (Displayed Conditionally)

Description: Shown only when "Turnkey" is "No". Represents the annual financing cost for the station, calculated as a percentage of the station cost, paid throughout the analysis period.

Calculation:

Monthly Rate = 1.5% (AGLC) or 1.6% (CGC)

Annual Cost = Station Cost * (Monthly Rate * 12)

Affecting Variables:

stationConfig.turnkey (Must be "No")

stationConfig.businessType (AGLC/CGC)

stationConfig.stationType (Affects Station Cost)

vehicleParameters (all Counts affect Station Cost)

Component: AdditionalMetrics.tsx

Metric: Total CO₂ Emissions Saved

Description: The total cumulative CO₂ emissions saved over the entire time horizon, expressed in metric tons.

Calculation: results.totalEmissionsSaved / 1000 (Value from the last element of results.cumulativeEmissionsSaved, converted from kg to tons).

Affecting Variables:

vehicleParameters (all Counts, all MPG)

deploymentStrategy / vehicleDistribution

timeHorizon

Metric: CO₂ Reduction Percentage

Description: Same as summary metric. Percentage reduction in CO₂ compared to baseline.

Calculation: Same as summary.

Affecting Variables: (Same as Total CO₂ Emissions Saved)

Metric: Cost per Mile (Gasoline)

Description: The estimated cost to operate a light-duty vehicle for one mile using gasoline.

Calculation: Cost Per Mile = fuelPrices.gasolinePrice / vehicleParameters.lightDutyMPG (Based on results.costPerMileGasoline calculation in lib/calculator.ts).

Affecting Variables:

fuelPrices.gasolinePrice

vehicleParameters.lightDutyMPG

Metric: Cost per Mile (CNG)

Description: The estimated cost to operate a light-duty vehicle for one mile using CNG, accounting for adjusted price and efficiency loss.

Calculation: Cost Per Mile = Adjusted CNG Price per GGE / (vehicleParameters.lightDutyMPG * (1 - CNG_LOSS.light)). (Based on results.costPerMileCNG calculation in lib/calculator.ts). Adjusted CNG Price includes base rate, electricity, LDC markup.

Affecting Variables:

fuelPrices.cngPrice

stationConfig.businessType (AGLC/CGC)

vehicleParameters.lightDutyMPG

CNG Loss Constant (Light Duty)

Metric: Cost Reduction (%)

Description: The percentage difference between the cost per mile of gasoline (for light duty) and CNG.

Calculation: Cost Reduction % = ((Gasoline CPM - CNG CPM) / Gasoline CPM) * 100

Affecting Variables: (All variables affecting Gasoline CPM and CNG CPM for Light Duty)

Metric: Annual Fuel Savings (In Operational Metrics)

Description: Same as the summary metric in FleetConfiguration (Average Annual Net Savings).

Calculation: Same as summary.

Affecting Variables: Same as summary.

This revised list focuses strictly on the metrics displayed and their associated details for the hover feature. Remember that the "Turnkey" option is a critical factor influencing how Total Investment, Payback Period, ROI, and Yearly Savings are calculated and interpreted.